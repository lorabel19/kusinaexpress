{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KusinaExpress | Home</title>
<style>
  * { margin:0; padding:0; box-sizing:border-box; font-family:'Poppins', sans-serif; }
  body { background-color:#fffaf3; color:#2d2d2d; }

  header {
    background-color: #d62828;
    color: white;
    padding: 20px 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  }

  header h1 { font-size:26px; letter-spacing:1px; }
  nav { display:flex; align-items:center; gap:10px; }
  nav a { color:white; margin:0 10px; text-decoration:none; font-weight:600; transition: color 0.3s; position: relative; }
  nav a:hover { color:#fcbf49; }

  .cart-badge {
    position: absolute;
    top: -5px;
    right: -17px;
    background:red;
    color:white;
    font-size:12px;
    font-weight:bold;
    border-radius:50%;
    padding:2px 6px;
    display:none; 
  }

  .auth-button { margin-left:15px; padding-left:15px; border-left:2px solid rgba(255,255,255,0.3); }
  .auth-button a img { width:30px; height:30px; border-radius:50%; }

  .hero {
    background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)),
    url('https://static.vecteezy.com/system/resources/previews/029/287/456/large_2x/ai-generated-of-a-chicken-adobo-on-a-table-free-photo.jpg');
    background-size: cover;
    background-position: center;
    height:420px;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    text-align:center;
    color:white;
    padding:0 20px;
  }
  .hero h2 { font-size:48px; margin-bottom:15px; font-weight:700; color:#fff; }
  .hero p { font-size:20px; color:#f8edeb; max-width:600px; }

  section { padding:60px 40px; }
  h2.section-title { color:#d62828; font-size:32px; margin-bottom:30px; font-weight:700; }

  .featured, .promotions { display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:25px; }
  .card { background:#fff; border-radius:15px; overflow:hidden; box-shadow:0 4px 15px rgba(0,0,0,0.1); text-align:center; transition: transform 0.3s ease, box-shadow 0.3s ease; }
  .card:hover { transform:translateY(-10px); box-shadow:0 8px 20px rgba(0,0,0,0.2); }
  .card img { width:100%; height:200px; object-fit:cover; }
  .card h3 { color:#d62828; margin:15px 0 10px; font-weight:700; }
  .card p { color:#555; padding:0 15px 20px; font-size:15px; line-height:1.5; }

  /* FOOTER */
  footer { background-color:#3a0ca3; color:white; text-align:center; padding:25px; margin-top:50px; font-size:14px; }
  footer a { color:#fcbf49; text-decoration:none; font-weight:600; }
  footer a:hover { text-decoration:underline; }

  /* Toast notification */
  #toast { position: fixed; bottom:20px; right:20px; background:#27ae60; color:white; padding:10px 20px; border-radius:6px; opacity:0; pointer-events:none; transition: opacity 0.5s; z-index:200; }
</style>
</head>
<body>

<header>
  <h1>KusinaExpress</h1>
  <nav>
    <a href="{% url 'restaurant:dashboard' %}">Home</a>
    <a href="{% url 'restaurant:menu' %}">Menu</a>
    <a href="{% url 'restaurant:cart' %}" class="cart-button">
      Cart
      <span id="cartBadge" class="cart-badge"></span>
    </a>
    <a href="{% url 'restaurant:order' %}">Order</a>
    <a href="#">Contact</a>
    <a href="#">About Us</a>
    <div class="auth-button">
      {% if user %}
        <a href="{% url 'restaurant:home' %}">
          <img src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Profile">
        </a>
      {% endif %}
    </div>
  </nav>
</header>

<section class="hero">
  <h2>Welcome to KusinaExpress</h2>
  <p>Bringing Filipino comfort food straight to your doorstep fast, fresh, and flavorful!</p>
</section>

<section>
  <h2 class="section-title">Featured Dishes</h2>
  <div class="featured">
    <div class="card">
      <img src="https://images.deliveryhero.io/image/fd-ph/LH/t7o8-listing.jpg" alt="Adobo">
      <h3>Adobo</h3>
      <p>Tender pork or chicken slowly cooked in soy sauce, vinegar, garlic, and bay leaves – a true Filipino classic.</p>
    </div>
    <div class="card">
      <img src="https://www.unileverfoodsolutions.com.ph/dam/global-ufs/mcos/SEA/calcmenu/recipes/PH-recipes/appetisers/sizzling-pork-sisig-manila/sizzling-pork-sisig-manila-main.jpg" alt="Sinigang">
      <h3>Sinigang</h3>
      <p>A comforting sour soup made with tamarind, fresh vegetables, and your choice of pork, shrimp, or fish.</p>
    </div>
    <div class="card">
      <img src="https://www.maggi.ph/sites/default/files/inline-images/Bulalo.jpg" alt="Kare-Kare">
      <h3>Kare-Kare</h3>
      <p>Rich peanut stew with oxtail and vegetables, best paired with bagoong (shrimp paste).</p>
    </div>
  </div>
</section>

<section>
  <h2 class="section-title">Promotions & Deals</h2>
  <div class="promotions">
    <div class="card">
      <img src="https://img.ph.my-best.com/product_images/5e045c5b532c925cf2dcb2ca7f864bc0.jpg?ixlib=rails-4.3.1&q=70&lossless=0&w=800&h=800&fit=clip&s=2b05ffc576fb681475d94d45fc7d4e3c" alt="Meal Combo">
      <h3>Meal Combo</h3>
      <p>Enjoy more for less! Choose from our best-selling dishes paired with rice and a drink — perfect for any meal.</p>
    </div>
    <div class="card">
      <img src="https://upload.wikimedia.org/wikipedia/commons/c/cc/Lechon_Kawali.jpg" alt="Free Delivery">
      <h3>Free Delivery</h3>
      <p>Order now and get your favorite Filipino dishes delivered to your doorstep with no delivery charge for minimum orders!</p>
    </div>
    <div class="card">
      <img src="https://www.nagacityguide.com/wordpress/wp-content/uploads/2023/09/photo_2023-09-06_12-13-07.jpg" alt="Student Discount">
      <h3>Student Discount</h3>
      <p>Students get 10% off on all meals! Just present your valid school ID upon checkout.</p>
    </div>
  </div>
</section>

<footer>
  <p>© 2025 KusinaExpress | Proudly Serving Filipino Flavors</p>
</footer>

<div id="toast">Item added to cart!</div>

<script>
// CSRF helper
function getCookie(name){
  let cookieValue = null;
  if(document.cookie && document.cookie!==''){
    document.cookie.split(';').forEach(cookie=>{
      if(cookie.trim().startsWith(name+'=')){
        cookieValue = decodeURIComponent(cookie.trim().split('=')[1]);
      }
    });
  }
  return cookieValue;
}

// Show toast
function showToast(msg){
  const toast = document.getElementById('toast');
  toast.innerText = msg;
  toast.style.opacity = 1;
  setTimeout(()=>{ toast.style.opacity = 0; }, 2000);
}

// Update cart badge
async function updateCartBadge(){
  try{
    const res = await fetch('/api/cart/');
    if(!res.ok) return;
    const items = await res.json();
    const count = items.reduce((acc,i)=>acc+i.quantity,0);
    const badge = document.getElementById('cartBadge');
    if(count>0){
      badge.innerText = count;
      badge.style.display = 'inline-block';
    } else {
      badge.style.display = 'none';
    }
  }catch(err){ console.error(err); }
}

// Initial fetch
updateCartBadge();

// Optional: poll every 10s in case cart updates in another tab
setInterval(updateCartBadge, 10000);
</script>

</body>
</html>
